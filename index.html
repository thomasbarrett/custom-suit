<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js webgl - OBJLoader + MTLLoader</title>
		<meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet">
        <script src="https://kit.fontawesome.com/ec135c73c5.js"></script>
        <link rel="stylesheet" href="css/index.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/108/three.min.js"></script>
	</head>
	<body>
        <header>
            <img class="speedo" src="images/speedo-logo-small.png" alt="Speedo">
            <div>
                <a href="https://www.speedousa.com/women">Women</a>
                <a href="https://www.speedousa.com/men">Men</a>
                <a href="https://www.speedousa.com/kids">Kids</a>
                <a href="https://www.speedousa.com/goggles">Goggles</a>
                <a href="https://www.speedousa.com/gear">Gear</a>
                <a href="https://www.speedousa.com/team">Team</a>
                <a href="https://www.speedousa.com/sales">Sales</a>
                <a href="https://www.speedousa.com/">Customize</a>
            </div>
            <div>
                <i class="fas fa-search"></i>
                <span>Account</span>
                <i class="fas fa-shopping-cart"></i>
            </div>
        </header>
        <div class="customization">
            <h1 class='title'></h1>
            <div class="hidden row"></div>
        </div>
        <script>
            // First we get the viewport height and we multiple it by 1% to get a value for a vh unit
            let vh = window.innerHeight * 0.01;
            // Then we set the value in the --vh custom property to the root of the document
            document.documentElement.style.setProperty('--vh', `${vh}px`);

            // We listen to the resize event
            window.addEventListener('resize', () => {
            // We execute the same script as before
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
            });
        </script>
        <script type="module">
            import {stitching, fabric, liner, strap, front, left, right, modelNotifier} from './src/index.js'
            
            let colors = [
                '#3C3C3C',
                '#4287F5',
                '#32A852',
                "#FCBA03",
                "#EB4034",
                "#B6FFEA",
                "#FCE2AE",
                "#FFB3B3",
                "#FFDCF7",
                "#75D5FD",
                "#B76CFD",
                "#FF2281",
                "#011FFD"
            ];
            
            let activeElement = null;

            let row = document.querySelector('.row');
            colors.forEach(color => {
                let colorElement = document.createElement('div');
                colorElement.classList.add('square');
                colorElement.style.background = color;
                colorElement.onclick = () => {
                    activeElement.forEach(element => {
                        element.material = element.material.clone();
                        element.material.color.set(parseInt(color.substr(1), 16));
                    })
                }
                row.appendChild(colorElement);
            })

            modelNotifier.subscribe('front-side', (object) => {
                let title = document.querySelector('.title');
                title.innerText = "Front"
                activeElement = object;
                console.log(object);
                document.querySelector('.row').classList.remove('hidden');
            });

            modelNotifier.subscribe('back-strap', (object) => {
                let title = document.querySelector('.title');
                title.innerText = "Back Strap";
                activeElement = object;
                document.querySelector('.row').classList.remove('hidden');
            });

            modelNotifier.subscribe('left-side', (object) => {
                let title = document.querySelector('.title');
                title.innerText = "Left Side";
                activeElement = object;
                document.querySelector('.row').classList.remove('hidden');
            });

            modelNotifier.subscribe('right-side', (object) => {
                let title = document.querySelector('.title');
                title.innerText = "Right Side";
                activeElement = object;
                document.querySelector('.row').classList.remove('hidden');
            });

            modelNotifier.subscribe('inner-lining', (object) => {
                let title = document.querySelector('.title');
                title.innerText = "Inner Lining";
                activeElement = object;
                document.querySelector('.row').classList.remove('hidden');
            });

            modelNotifier.subscribe('upper-straps', (object) => {
                let title = document.querySelector('.title');
                title.innerText = "Upper Straps";
                activeElement = object;
                document.querySelector('.row').classList.remove('hidden');
            });

            modelNotifier.subscribe('clear', (object) => {
                let title = document.querySelector('.title');
                title.innerText = "";
                document.querySelector('.row').classList.add('hidden');
            });
        </script>
	</body>
</html>